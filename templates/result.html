<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Boolean Expression Result</title>
    <!-- Add any additional styles or scripts if needed -->
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css')}}">
</head>
<body>
    <div class="solution">
        <h2 class="sol">Solution: </h2>
        <h2>Given minterms are: 
            {%for i in minterm%}
            {{i}}
            {%endfor%}
        </h2>
        <h2>
            {%if dontcares|length > 0%}
                Given Dont cares are:
                {%for i in dontcares%}
                    {{i}}
                {%endfor%}
            {%endif%}
        </h2>
        <h2>
            {% for i in sol %}
            <center>
            <table>
                <caption>Step-{{ loop.index }}</caption>
                {%if loop.first%}
                Representing the minterms as groups in increasing number of ones
                {%endif%}
                <tr>
                    <td>Group</td>
                    <td>Pair</td>
                    <td>Binary Representation</td>
                </tr>
                {% for j, group in i.items() %}
                    {% for k in group %}
                        <tr>
                            {% if loop.first %}
                                    <td rowspan="{{ group|length }}">{{ j }}</td>
                                {% endif %}
                            {%for l in k.items()%}
                                <td>{{l[0]}}</td>
                                <td>{{l[-1]}}</td>
                            {%endfor%}
                        </tr>
                    {% endfor %}
                {% endfor %}
            </table>
        </center>
        {% endfor %}
    </h2>
    <h2>
        <p>Prime Implicant Chart</p>
        <center>
        <table>
            <tr>
                <td>Minterms</td>
                {%for i in minterm%}
                    <td>{{i}}</td>
                {%endfor%}
                <td>Expression</td>
            <tr>
            {%for i in prime_implicant_chart%}
            <tr>
                {% for j in i%}
                <td>{{j}}</td>
                {%endfor%}
            </tr>
            {%endfor%}
        </table>
        {% set exp = [] %}
        {% for i in prime_implicant_chart%}
            {%set _=exp.append(i[-1])%}
        {% endfor %}
        {%set terms=[]%}
        {%for i in prime_implicant_chart%}
            {%set _=terms.append(i[0])%}
        {%endfor%}
        {%set exp1=[]%}
        {%for i in reduced_chart[0]%}
            {%set _=exp1.append(i[-1])%}
        {%endfor%}
        {%set terms1=[]%}
        {%for i in reduced_chart[0]%}
            {%set _=terms1.append(i[0])%}
        {%endfor%}
        {%set res=[]%}
        {%for i in exp%}
            {%if i not in exp1%}
            {%set _=res.append(i)%}
            {%endif%}
        {%endfor%}
        {%for i in terms%}
        {%if i not in terms1%}
        {%set _=res.append(i)%}
        {%endif%}
        {%endfor%}
        remove the Row containing {{res[0]}}  {{(res[1])}} as the minterms and columns that contains the minterms  {{(res[1])}} 
    </center>
    </h2>
    <h2>
        {% for i in reduced_chart%}
            {%if i%}
                <p>Reduced Prime Implicant Chart</p>
                <center>
                    <table>
                        <tr>
                            <td>Minterms</td>
                            {% for j in reduced_minterms[loop.index-1] %}
                                <td>{{ j }}</td>
                            {% endfor %}
                            <td>Expression</td>
                        </tr>
                        {% for j in i %}
                            <tr>
                                {% for k in j %}
                                    <td>{{ k }}</td>
                                {% endfor %}
                            </tr>
                        {% endfor %}
                    </table>
                </center>
            
                {% set exp=[] %}
                {% set terms=[] %}
                {% set exp1=[] %}
                {% set terms1=[] %}
                {% for k in reduced_chart[loop.index-1] %}
                    {% set _=exp.append(k[-1]) %}
                {% endfor %}
                {% for k in reduced_chart[loop.index] %}
                    {% set _=exp1.append(k[-1]) %}
                {% endfor %}
                {% for k in reduced_chart[loop.index-1] %}
                    {% set _=terms.append(k[0]) %}
                {% endfor %}
                {% for k in reduced_chart[loop.index] %}
                    {% set _=terms1.append(k[0]) %}
                {% endfor %}
            
                {% set res=[] %}
                {% for i in exp %}
                    {% if i not in exp1 %}
                        {% set _=res.append(i) %}
                    {% endif %}
                {% endfor %}
                {% for i in terms %}
                    {% if i not in terms1 %}
                        {% set _=res.append(i) %}
                    {% endif %}
                {% endfor %}
                {%if loop.last%}
                There is no columns that contain single X so we need to stop here and apply patrik's method to solve the reduced prime implicant Chart
                {%else%}
                remove the Row containing {{ res[0] }}  {{ res[1] }} as the minterms and columns that contain the minterms {{ res[1] }}
                {%endif%}
            {%endif%}
    {% endfor %}
    </h2>
    {%if remaining_minterms%}
    <h2>
        <h3>Apply Patrik's Method to the reduced prime implicant chart</h3>
        <p class="patrik">By Using Patrik's Method we can write the expression for P as <br><br>
        {%set remaining_minterms=[]%}
        {%for i in reduced_chart[-1]%}
        {%set _ =remaining_minterms.append(i[-1])%}
        {%endfor%}
        {%set list1=[]%}
        {%for i in range(1,reduced_chart[-1][0]|length -1)%}
            {%set tuple1=[]%}
            {%for j in reduced_chart[-1]%}
            {%if(j[i]=="X")%}
                {%set _=tuple1.append(loop.index-1)%}
            {%endif%}
            {%endfor%}
            {%set _ =list1.append(tuple1)%}
        {%endfor%}
        P=
        {%for i in list1%}
            {%for j in range(i|length)%}
                {%if j==0%}
                    (P{{i[j]}}.
                {%else%}
                    P{{i[j]}})
                {%endif%}
            {%endfor%}
            {%if loop.last%}
            {%else%}
            +
            {%endif%}
        {%endfor%}
        <br>
        Where <br>
        {%for i in range(remaining_minterms|length)%}
            P{{i}}={{remaining_minterms[i]}}<br>
        {%endfor%}
    </h2>
    <h2 class="solution">
        After solving the above equation<br>
        Possible Solutions is:<br><br>
        <!--For displaying the possible solutions-->
        {% for i in expression %}
        {{i}}<br>
        {% endfor %}
    </h2>
    <h2>
        Now substitute the values of the 
            {%for i in range(remaining_minterms|length)%}
            {%if loop.last%}
                {{"P".lower()}}{{i}}
            {%else%}
                {{"P".lower()}}{{i}},
            {%endif%}
            {%endfor%}
        
    </h2>
    {%endif%}
    <h2>
        Possible Solutions are:<br><br>
        {%for i in ans%}
        {{"+".join(i)}}<br>
        {%endfor%}
        {%if simplified_expression|length%}
        It can be also Written as {{simplified_expression}}
        {%endif%}
    </h2>
    </div>
</body>
</html>
